# 02-2 深入搜集开放信息与查点

当我们已经对目标，比如它的公司的外部门户网站进行了充分的外围情报信息搜集，了解到网站域名、ip地址，并进一步针对门户网站搜集到一些关于此目标公司业务、人员与网站服务的细节信息。接着，我们就可以从外围信息搜集转到直接与目标网络环境进行交互，进行深入的信息搜集。

通过扫描的指纹值上的操作系统版本号或者应用程序版本号，寻找对应的漏洞信息。根据探测到的信息和对应的漏洞信息，利用漏洞，从而进行渗透。

## 扫描——搜集信息

活跃主机扫描，确定目标网络中那些主机在线（Ping Sweep技术）

标识目标系统开放的端口与服务（Port Scan技术）

操作系统识别（Operating System Identification/OS printing技术）

### 在线活跃主机扫描——ping sweep

活跃主机指已连接到网络上、处于运行状态且网络功能正常的主机。通常目标网络上会有很多已关闭电源的主机或空闲（没有主机使用）的IP段，需要首先从大范围的IP地址段中寻找出活跃的主机，然后进一步筛选出你感兴趣的目标主机

需要在较短的时间中，在较大的网络范围中确定“活”的机器

主要利用的原理：

- ICMP sweeps(ICMP ECHO requests)
- Broadcast ICMP
- TCP Sweep/UDP Sweep

### Port(TCP/UDP) Scan

端口扫描就是连接到目标系统的TCP或UDP端口上，确定哪些服务正在运行。

常见的扫描工具有：

- fping
- superscan
- nmap

主要目的：

- 确定目标系统上的TCP/UDP服务
- 标识目标系统的OS类型
- 更深入一步可以标识特定的应用程序或特定服务的版本

#### TCP 端口扫描

两台主机利用TCP来进行数据传输的话就必须先建立链接。端口扫描器就利用这个原理，它先给指定IP指定端口发送一个SYN请求数据包，假若目标主机受到该请求数据包的话就会对另一方有所回应。

#### UDP端口扫描

主要依赖不开放的UDP端口将回应ICMP Port Unreachable消息。其结果不可靠的几个原因：

- 路由器经常丢弃UDP分组
- 许多UDP服务不响应探询
- 防火墙通常配置为丢弃DNS查询外的所有UDP分组





























